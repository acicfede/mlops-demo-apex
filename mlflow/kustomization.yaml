apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: mlflow

# -------------------------------------------------------------------
# Risorse statiche (Deployment, PVC, Datasource CM, Route, Secretâ€¦)
# -------------------------------------------------------------------
resources:
  - grafana.yaml
  - mlflow-server.yaml
  - postgresql.yaml

# -------------------------------------------------------------------
# Genera automaticamente le ConfigMap con le dashboard JSON
# -------------------------------------------------------------------
configMapGenerator:
  - name: grafana-dashboard-mlflow
    namespace: mlflow
    files:
      - mlflow-training-dashboard.json=./dashboards/mlflow-training-dashboard.json

  - name: grafana-dashboard-vllm
    namespace: mlflow
    files:
      - vllm-dashboard.json=./dashboards/vllm-dashboard.json

# -------------------------------------------------------------------
# Permette rigenerazione automatica delle CM se i file cambiano
# -------------------------------------------------------------------
generatorOptions:
  disableNameSuffixHash: true
